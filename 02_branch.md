# 2. ブランチ・マージ編

- ブランチとは？
  - ブランチとは、枝分かれした、それぞれのコミットの履歴のこと
	- 「branch」は「木の枝」の意味 ブランチの実体は、一連のコミットの先頭を指すポインタ
	- ブランチを導入すると以下のようなメリットがある
		1. チーム開発がやりやすくなる
		2. コミット履歴がわかりやすくなる
	- ソフトウェア開発では、新機能を開発しながら、 既存のバグを修正するなど、並行して作業を行うことが多い
	- このような場合、他の作業に影響を受けない・与えない仕組みが必要になる そのために用いるのがブランチ
	- 開発の目的ごとにブランチを分けることで、 それぞれ独立して開発が可能になるのでチーム開発がやりやすくなる
	- 例えば、
		1. リリース版のブランチ
		2. バグ修正のブランチ
		3. 機能追加のブランチ
	- ブランチはマージすることによって、 それぞれの最新コミットの内容を１つにまとめることができる
- メインブランチとは？
	- Gitリポジトリを作成したときに自動的に作成されるブランチ
		- 今までは「master」がデフォルトの名前だったが、 人権運動を背景に、今後は「main」に変わっていく GitHubではすでにmainになっている
- マージとは？
	- 2つのブランチを１つに統合すること
	- より正確に言うと、 ２つのブランチそれぞれの最新コミットの内容を統合する新しいコミットを現在のブランチに作ること
	- 例えば、新機能追加のブランチでの開発が完成し、正しく動作するようになったら、 機能追加のブランチとリリース版のブランチをマージして統合する

![branch](./img/branch.png)

- 既存のブランチの一覧を表示する
	- `$ git branch`
	- このコマンドの出力では、 HEADがあるブランチの横に「`*`」マークがついている
- ブランチを新規作成する
	- `$ git branch new-feature`
- mainブランチから作成した「new-feature」ブランチに切り替える
	- `$ git checkout new-feature`
	- 「git checkout」は本来、HEADを移動するコマンド 引数にブランチを指定するとブランチにHEADを移動できる つまり、ブランチを切り替えることができる
- 「bug-fix」というブランチを新規作成した上で、 masterブランチからこのブランチに切り替える
	- `$ git checkout -b bug-fix`
- 追加、修正を行う
- new-featureブランチからmainブランチに切り替える
	- `$ git checkout main`
- 今作業をしているmainブランチと、new-featureブランチをマージする
	- `$ git merge new-feature`
	- 変更箇所が重複していない場合は、 「git merge」によって自動でマージが行われるが、 重複している場合はコンフリクトが発生する
	- コンフリクトが発生したらワークツリーを手動で修正した上で「git add」と「git commit」を行う
- new-featureブランチを削除する
	- `$ git branch -d new-feature`
	- 最新コミットがマージされていないブランチを強制的に削除するには、 「-d」オプションの代わりに、「-D」オプションを付けて以下のように実行する
	- `$ git branch -D <branch name>`
- oldbranchブランチをnewbranchという名前に変更する
	- `$ git branch -m oldbranch newbranch`

